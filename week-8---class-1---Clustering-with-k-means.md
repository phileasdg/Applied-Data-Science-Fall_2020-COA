---
title: "week 8 - class 1 - Clustering with k-means"
author: "Phileas Dazeley Gaist"
date: "11/2/2021"
output:
  html_document:
    df_print: paged
    keep_md: true
---


```r
# # ---------------------------------------------------------------
# ┏━━━┓╋╋┏┓┏┓╋╋╋╋╋╋╋╋╋╋╋╋╋╋┏━┓╋┏┓┏┓╋╋╋╋╋┏━━━┓┏┓┏┓╋╋╋╋╋╋┏┓
# ┃┏━┓┃╋╋┃┃┃┃╋╋╋╋╋╋╋╋╋╋╋╋╋╋┃┏┛┏┛┗┫┃╋╋╋╋╋┃┏━┓┣┛┗┫┃╋╋╋╋╋┏┛┗┓
# ┃┃╋┗╋━━┫┃┃┃┏━━┳━━┳━━┓┏━━┳┛┗┓┗┓┏┫┗━┳━━┓┃┃╋┃┣┓┏┫┃┏━━┳━╋┓┏╋┳━━┓
# ┃┃╋┏┫┏┓┃┃┃┃┃┃━┫┏┓┃┃━┫┃┏┓┣┓┏┛╋┃┃┃┏┓┃┃━┫┃┗━┛┃┃┃┃┃┃┏┓┃┏┓┫┃┣┫┏━┛
# ┃┗━┛┃┗┛┃┗┫┗┫┃━┫┗┛┃┃━┫┃┗┛┃┃┃╋╋┃┗┫┃┃┃┃━┫┃┏━┓┃┃┗┫┗┫┏┓┃┃┃┃┗┫┃┗━┓
# ┗━━━┻━━┻━┻━┻━━┻━┓┣━━┛┗━━┛┗┛╋╋┗━┻┛┗┻━━┛┗┛╋┗┛┗━┻━┻┛┗┻┛┗┻━┻┻━━┛
# ╋╋╋╋╋╋╋╋╋╋╋╋╋╋┏━┛┃
# ╋╋╋╋╋╋╋╋╋╋╋╋╋╋┗━━┛       Applied Data Science I - Week 8, Class 1
# # ---------------------------------------------------------------
```




```r
# # ---------------------------------------------------------------
# # 
# # Required Packages / Settings
# # 
# # ---------------------------------------------------------------#
#
library(tidyverse)
```

```
## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --
```

```
## v ggplot2 3.3.5     v purrr   0.3.4
## v tibble  3.1.5     v dplyr   1.0.7
## v tidyr   1.1.4     v stringr 1.4.0
## v readr   2.0.1     v forcats 0.5.1
```

```
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
```

```r
# 
# You'll need to download this one!
# install.packages("tidymodels")
library(tidymodels)
```

```
## Registered S3 method overwritten by 'tune':
##   method                   from   
##   required_pkgs.model_spec parsnip
```

```
## -- Attaching packages -------------------------------------- tidymodels 0.1.4 --
```

```
## v broom        0.7.9      v rsample      0.1.0 
## v dials        0.0.10     v tune         0.1.6 
## v infer        1.0.0      v workflows    0.2.4 
## v modeldata    0.1.1      v workflowsets 0.1.0 
## v parsnip      0.1.7      v yardstick    0.0.8 
## v recipes      0.1.17
```

```
## -- Conflicts ----------------------------------------- tidymodels_conflicts() --
## x scales::discard() masks purrr::discard()
## x dplyr::filter()   masks stats::filter()
## x recipes::fixed()  masks stringr::fixed()
## x dplyr::lag()      masks stats::lag()
## x yardstick::spec() masks readr::spec()
## x recipes::step()   masks stats::step()
## * Use tidymodels_prefer() to resolve common conflicts.
```

```r
#
```

In data science, **labels** are the features you are trying to predict and/or understand. 

In machine learning and statistics, feature selection, also known as variable selection, attribute selection or variable subset selection, is the process of selecting a subset of relevant features for use in model construction


```r
# # ---------------------------------------------------------------
# # 
# # How does k-means work!
# # 
# # Adapted from https://www.tidymodels.org/learn/statistics/k-means/ 
# # 
# # ---------------------------------------------------------------

# First, let's set a seed so we can make this reproducible! 

# Labels are the features you are trying to predict and/or understand. 

set.seed(20211102)

# Now, Let’s start by generating some random two-dimensional data with four clusters. 
# Data in each cluster will come from a multivariate Gaussian (normal) distribution, with different means for each cluster:

# This generates - deterministicaly - the actual center coordinates of our clusters
centers <- tibble(
  cluster = factor(1:4), 
  num_points = c(100, 150, 50, 200),  # number points in each cluster
  x1 = c(5, 0, -3, 2),              # x1 coordinate of cluster center
  x2 = c(-1, 2, 0, 4)
)

centers
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["cluster"],"name":[1],"type":["fct"],"align":["left"]},{"label":["num_points"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["x1"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["x2"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"100","3":"5","4":"-1"},{"1":"2","2":"150","3":"0","4":"2"},{"1":"3","2":"50","3":"-3","4":"0"},{"1":"4","2":"200","3":"2","4":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>


```r
# This generates the random multivariate Gaussian distributions (the data set with clusters which we are going to test for clusters using k-means)

labelled_points <- 
  centers %>%
  mutate(
    x1 = map2(num_points, x1, rnorm), # map2 says "take num_points and x1, and calculate a normal distribution with the appropriate number of points and mean x1.
    x2 = map2(num_points, x2, rnorm)
  ) %>% 
  select(-num_points) %>% 
  unnest(cols = c(x1, x2))

# Plot to prove what we did :) 

ggplot(labelled_points, aes(x1, x2, color = cluster)) +
  geom_point(alpha = 0.5) + 
  theme_bw()
```

![](week-8---class-1---Clustering-with-k-means_files/figure-html/unnamed-chunk-4-1.png)<!-- -->


```r
# Let's how well k-means clustering works! 

points <- 
  labelled_points %>% 
  select(-cluster)

kclust <- kmeans(points, centers = 4)
kclust
```

```
## K-means clustering with 4 clusters of sizes 195, 100, 147, 58
## 
## Cluster means:
##            x1         x2
## 1  2.10067656  4.0165848
## 2  4.93754043 -0.9851590
## 3  0.04500604  1.8702414
## 4 -2.78183242  0.3612606
## 
## Clustering vector:
##   [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
##  [38] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
##  [75] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 4 3 3 3 3 3
## [112] 3 3 3 4 3 1 3 3 3 3 3 3 3 3 3 4 3 3 3 4 3 3 3 4 3 3 3 3 3 3 3 1 3 3 3 3 3
## [149] 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 3 3 4 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3 3 1 3 3
## [186] 3 3 3 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 3 3 3 3 3 3 3 3 3 3 3
## [223] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 3 3 3 3 4 4 4 4 4 4 4 4 4
## [260] 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
## [297] 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 3 1 1 1 1 1 1 1 1 1 1 3 1 3 1 1 1 1 1 1 1 1
## [334] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [371] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 3 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [408] 1 1 1 1 1 1 1 1 1 3 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [445] 1 1 1 1 3 1 1 1 3 3 1 1 1 3 1 1 1 1 1 1 1 1 1 1 3 1 1 1 1 1 1 1 1 1 1 1 1
## [482] 1 1 1 1 1 3 1 1 1 1 1 1 1 1 1 1 1 1 1
## 
## Within cluster sum of squares by cluster:
## [1] 325.2082 193.9269 253.1424 113.2072
##  (between_SS / total_SS =  83.5 %)
## 
## Available components:
## 
## [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
## [6] "betweenss"    "size"         "iter"         "ifault"
```

```r
# The output is a list of vectors, where each component has a different length. 
# There’s one of length 500, the same as our original data set. 
# There are two elements of length 4 (withinss and tot.withinss) and centers is a matrix with 4 rows. 
# And then there are the elements of length 1: totss, tot.withinss, betweenss, and iter. (The value ifault indicates possible algorithm problems.)

# These differing lengths have important meaning when we want to tidy our data set; 
# they signify that each type of component communicates a different kind of information.

summary(kclust)
```

```
##              Length Class  Mode   
## cluster      500    -none- numeric
## centers        8    -none- numeric
## totss          1    -none- numeric
## withinss       4    -none- numeric
## tot.withinss   1    -none- numeric
## betweenss      1    -none- numeric
## size           4    -none- numeric
## iter           1    -none- numeric
## ifault         1    -none- numeric
```

```r
# cluster (500 values) contains information about each point
# centers, withinss, and size (4 values) contain information about each cluster
# totss, tot.withinss, betweenss, and iter (1 value) contain information about the full clustering

# Which of these do we want to extract? There is no right answer; each of them may be interesting to an analyst. 
# Because they communicate entirely different information (not to mention there’s no straightforward way to combine them), 
# they are extracted by separate functions: augment, tidy, and glance! 

# The augment() adds the point classifications to the original data set: (it automatically selects the output part of your model and slaps it onto your data set)

augment(kclust, labelled_points)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["cluster"],"name":[1],"type":["fct"],"align":["left"]},{"label":["x1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["x2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".cluster"],"name":[4],"type":["fct"],"align":["left"]}],"data":[{"1":"1","2":"5.14402563","3":"-1.075197700","4":"2"},{"1":"1","2":"4.45500612","3":"-1.570001979","4":"2"},{"1":"1","2":"5.58041861","3":"-0.151159041","4":"2"},{"1":"1","2":"3.79873540","3":"-0.513769112","4":"2"},{"1":"1","2":"4.41621380","3":"-0.431225419","4":"2"},{"1":"1","2":"6.75816008","3":"-1.849988694","4":"2"},{"1":"1","2":"2.62456312","3":"-1.909906456","4":"2"},{"1":"1","2":"4.85827537","3":"-0.121179577","4":"2"},{"1":"1","2":"6.51656142","3":"-1.267605547","4":"2"},{"1":"1","2":"4.88495780","3":"-0.721346012","4":"2"},{"1":"1","2":"6.61449478","3":"-0.701361710","4":"2"},{"1":"1","2":"4.43784805","3":"-1.371607548","4":"2"},{"1":"1","2":"7.65399692","3":"-1.866008187","4":"2"},{"1":"1","2":"3.30810241","3":"-1.687547709","4":"2"},{"1":"1","2":"4.13472397","3":"-1.685900332","4":"2"},{"1":"1","2":"5.27549726","3":"-0.946749487","4":"2"},{"1":"1","2":"3.34078618","3":"1.154485033","4":"2"},{"1":"1","2":"3.76741384","3":"-0.359834729","4":"2"},{"1":"1","2":"6.13059591","3":"0.435757315","4":"2"},{"1":"1","2":"4.25466372","3":"-3.204406140","4":"2"},{"1":"1","2":"4.66567249","3":"0.108884722","4":"2"},{"1":"1","2":"5.02100468","3":"0.231683963","4":"2"},{"1":"1","2":"3.87870188","3":"-0.051565449","4":"2"},{"1":"1","2":"5.49458779","3":"-0.887010951","4":"2"},{"1":"1","2":"4.14646926","3":"-0.702318972","4":"2"},{"1":"1","2":"4.42312509","3":"-0.751746416","4":"2"},{"1":"1","2":"4.23922661","3":"0.283211357","4":"2"},{"1":"1","2":"5.44953562","3":"-1.954755895","4":"2"},{"1":"1","2":"5.34703480","3":"-0.994881671","4":"2"},{"1":"1","2":"3.68418838","3":"-0.077777371","4":"2"},{"1":"1","2":"4.32279939","3":"-1.386448829","4":"2"},{"1":"1","2":"3.95543370","3":"-0.972540810","4":"2"},{"1":"1","2":"5.49530010","3":"0.052106654","4":"2"},{"1":"1","2":"3.47023913","3":"-1.007938551","4":"2"},{"1":"1","2":"4.91394364","3":"-1.521155659","4":"2"},{"1":"1","2":"7.13514647","3":"-0.138103632","4":"2"},{"1":"1","2":"6.69475035","3":"0.888331307","4":"2"},{"1":"1","2":"4.89845010","3":"-2.850140825","4":"2"},{"1":"1","2":"5.39148350","3":"0.009333234","4":"2"},{"1":"1","2":"5.97731400","3":"-2.799111711","4":"2"},{"1":"1","2":"6.36383004","3":"-1.001145466","4":"2"},{"1":"1","2":"4.33751965","3":"1.364646843","4":"2"},{"1":"1","2":"3.97070351","3":"-0.372933309","4":"2"},{"1":"1","2":"4.91614523","3":"-1.215694178","4":"2"},{"1":"1","2":"3.87974631","3":"-0.589470021","4":"2"},{"1":"1","2":"5.41525947","3":"-1.507089070","4":"2"},{"1":"1","2":"5.32775223","3":"-0.208937172","4":"2"},{"1":"1","2":"4.84434569","3":"-0.914593134","4":"2"},{"1":"1","2":"5.51783240","3":"0.258418574","4":"2"},{"1":"1","2":"3.94556546","3":"-2.574894072","4":"2"},{"1":"1","2":"6.28551027","3":"-1.291197099","4":"2"},{"1":"1","2":"5.51629276","3":"-1.639950789","4":"2"},{"1":"1","2":"3.95185649","3":"-2.037634063","4":"2"},{"1":"1","2":"3.68036427","3":"-2.395002066","4":"2"},{"1":"1","2":"5.25394296","3":"-2.418667859","4":"2"},{"1":"1","2":"5.72417797","3":"-1.886224329","4":"2"},{"1":"1","2":"4.48934414","3":"-0.275033894","4":"2"},{"1":"1","2":"3.88986653","3":"-0.583512001","4":"2"},{"1":"1","2":"5.77546050","3":"-0.306846604","4":"2"},{"1":"1","2":"4.99749842","3":"-0.662288782","4":"2"},{"1":"1","2":"5.68120604","3":"-1.192950561","4":"2"},{"1":"1","2":"5.44187228","3":"-1.820204614","4":"2"},{"1":"1","2":"3.91704396","3":"-0.768040596","4":"2"},{"1":"1","2":"5.39204906","3":"-1.543141202","4":"2"},{"1":"1","2":"5.41895558","3":"-0.802131774","4":"2"},{"1":"1","2":"4.45485377","3":"-1.638104646","4":"2"},{"1":"1","2":"5.08714412","3":"-0.742268807","4":"2"},{"1":"1","2":"5.05188325","3":"-3.413863106","4":"2"},{"1":"1","2":"3.71204999","3":"-1.677509820","4":"2"},{"1":"1","2":"3.58627767","3":"-0.815820867","4":"2"},{"1":"1","2":"4.98298867","3":"-1.359118172","4":"2"},{"1":"1","2":"5.53558979","3":"0.018397999","4":"2"},{"1":"1","2":"4.92608875","3":"-1.323534110","4":"2"},{"1":"1","2":"4.74650621","3":"-1.250088577","4":"2"},{"1":"1","2":"4.61433888","3":"-1.163601899","4":"2"},{"1":"1","2":"4.82700356","3":"-0.302375093","4":"2"},{"1":"1","2":"4.58435799","3":"0.109388036","4":"2"},{"1":"1","2":"4.05685197","3":"-1.732696812","4":"2"},{"1":"1","2":"4.83378977","3":"-2.721066369","4":"2"},{"1":"1","2":"4.63864287","3":"0.083218519","4":"2"},{"1":"1","2":"3.85071942","3":"-1.871191387","4":"2"},{"1":"1","2":"2.51529358","3":"-2.258417984","4":"2"},{"1":"1","2":"6.01984706","3":"-0.122629546","4":"2"},{"1":"1","2":"4.47757341","3":"-1.158013189","4":"2"},{"1":"1","2":"4.92835810","3":"-1.396515819","4":"2"},{"1":"1","2":"8.78526396","3":"-1.279099090","4":"2"},{"1":"1","2":"4.79022053","3":"-1.744620367","4":"2"},{"1":"1","2":"5.55787500","3":"-1.337559523","4":"2"},{"1":"1","2":"4.26714366","3":"-1.457843188","4":"2"},{"1":"1","2":"4.37642222","3":"-1.545602732","4":"2"},{"1":"1","2":"5.74998936","3":"-2.120803679","4":"2"},{"1":"1","2":"6.03575726","3":"1.068282875","4":"2"},{"1":"1","2":"4.61424211","3":"-0.273661370","4":"2"},{"1":"1","2":"4.79231355","3":"-0.635787329","4":"2"},{"1":"1","2":"5.34234642","3":"-1.980882299","4":"2"},{"1":"1","2":"4.95012069","3":"-1.203242503","4":"2"},{"1":"1","2":"4.64116581","3":"-0.467030081","4":"2"},{"1":"1","2":"5.58241207","3":"1.447550179","4":"2"},{"1":"1","2":"6.32547948","3":"-0.225560484","4":"2"},{"1":"1","2":"6.01954388","3":"-1.273215623","4":"2"},{"1":"2","2":"-1.57444591","3":"3.165569237","4":"3"},{"1":"2","2":"0.39261659","3":"-0.038116709","4":"3"},{"1":"2","2":"0.10766807","3":"1.086219281","4":"3"},{"1":"2","2":"0.91964465","3":"0.561488172","4":"3"},{"1":"2","2":"-0.41078730","3":"2.605820331","4":"3"},{"1":"2","2":"-1.73620142","3":"-0.381089117","4":"4"},{"1":"2","2":"1.40426574","3":"1.891586763","4":"3"},{"1":"2","2":"0.55632882","3":"2.649822413","4":"3"},{"1":"2","2":"-0.74022518","3":"2.082076481","4":"3"},{"1":"2","2":"0.49344109","3":"1.943545667","4":"3"},{"1":"2","2":"0.11898905","3":"1.669580760","4":"3"},{"1":"2","2":"1.01432612","3":"0.118633309","4":"3"},{"1":"2","2":"0.06766445","3":"-0.085722970","4":"3"},{"1":"2","2":"-1.00805029","3":"1.058693540","4":"3"},{"1":"2","2":"-2.38258920","3":"1.775032037","4":"4"},{"1":"2","2":"1.66985428","3":"0.745239506","4":"3"},{"1":"2","2":"1.79302510","3":"2.651324397","4":"1"},{"1":"2","2":"-0.28700250","3":"1.893979699","4":"3"},{"1":"2","2":"-1.17023512","3":"2.286763017","4":"3"},{"1":"2","2":"0.10576501","3":"1.383834791","4":"3"},{"1":"2","2":"1.11867661","3":"2.499373343","4":"3"},{"1":"2","2":"-2.18735551","3":"3.519812957","4":"3"},{"1":"2","2":"-1.34279714","3":"2.150720426","4":"3"},{"1":"2","2":"-1.20818309","3":"1.155998093","4":"3"},{"1":"2","2":"-0.98973376","3":"1.675297351","4":"3"},{"1":"2","2":"0.18980706","3":"0.810497840","4":"3"},{"1":"2","2":"-2.06279280","3":"1.186826826","4":"4"},{"1":"2","2":"0.25054878","3":"1.603221805","4":"3"},{"1":"2","2":"-0.44692770","3":"0.989687266","4":"3"},{"1":"2","2":"-0.08598245","3":"1.798290677","4":"3"},{"1":"2","2":"-2.19126193","3":"1.594135107","4":"4"},{"1":"2","2":"0.68962986","3":"1.623980174","4":"3"},{"1":"2","2":"1.59079323","3":"2.083251470","4":"3"},{"1":"2","2":"1.06624965","3":"1.114556788","4":"3"},{"1":"2","2":"-1.94645619","3":"1.983546623","4":"4"},{"1":"2","2":"-0.46724708","3":"0.937680864","4":"3"},{"1":"2","2":"0.05759944","3":"2.003209595","4":"3"},{"1":"2","2":"0.53113361","3":"3.231906671","4":"3"},{"1":"2","2":"-0.12267447","3":"0.612027038","4":"3"},{"1":"2","2":"-0.06640198","3":"1.734550321","4":"3"},{"1":"2","2":"0.55182816","3":"2.243218508","4":"3"},{"1":"2","2":"-0.19379204","3":"1.539071687","4":"3"},{"1":"2","2":"1.09689002","3":"2.955898362","4":"1"},{"1":"2","2":"0.66845597","3":"2.092444146","4":"3"},{"1":"2","2":"-0.27518982","3":"2.325667508","4":"3"},{"1":"2","2":"-0.24807434","3":"0.066628593","4":"3"},{"1":"2","2":"-0.15607327","3":"1.102644211","4":"3"},{"1":"2","2":"0.28167259","3":"2.173246332","4":"3"},{"1":"2","2":"-0.32063475","3":"0.704115720","4":"3"},{"1":"2","2":"-0.75306393","3":"2.511155104","4":"3"},{"1":"2","2":"0.90370194","3":"2.005030855","4":"3"},{"1":"2","2":"1.99248250","3":"0.862199041","4":"3"},{"1":"2","2":"1.08675367","3":"2.089522556","4":"3"},{"1":"2","2":"1.19474078","3":"2.055608827","4":"3"},{"1":"2","2":"0.46927491","3":"2.803636023","4":"3"},{"1":"2","2":"-1.78468814","3":"2.894122488","4":"3"},{"1":"2","2":"0.53382077","3":"2.364826383","4":"3"},{"1":"2","2":"-0.72006129","3":"3.725137111","4":"3"},{"1":"2","2":"1.15127300","3":"3.186619251","4":"1"},{"1":"2","2":"-1.60827801","3":"2.210194714","4":"3"},{"1":"2","2":"0.90712799","3":"1.903275755","4":"3"},{"1":"2","2":"-1.32974377","3":"2.614768321","4":"3"},{"1":"2","2":"0.30717512","3":"2.480173640","4":"3"},{"1":"2","2":"-1.50314637","3":"2.668381552","4":"3"},{"1":"2","2":"0.76470481","3":"1.160910020","4":"3"},{"1":"2","2":"-2.53940311","3":"2.940027326","4":"4"},{"1":"2","2":"0.65759595","3":"0.612067001","4":"3"},{"1":"2","2":"0.36916302","3":"1.029096885","4":"3"},{"1":"2","2":"-0.56955624","3":"1.307647642","4":"3"},{"1":"2","2":"-0.02576842","3":"1.791257623","4":"3"},{"1":"2","2":"-0.40708547","3":"1.316528048","4":"3"},{"1":"2","2":"-0.46348665","3":"1.082645537","4":"3"},{"1":"2","2":"-0.73872597","3":"1.428039221","4":"3"},{"1":"2","2":"-0.09730280","3":"1.658686351","4":"3"},{"1":"2","2":"0.40720823","3":"1.805816087","4":"3"},{"1":"2","2":"-0.13794986","3":"1.401824748","4":"3"},{"1":"2","2":"-0.32474897","3":"3.597648870","4":"3"},{"1":"2","2":"0.17577400","3":"3.482423913","4":"3"},{"1":"2","2":"-1.21888419","3":"1.535493020","4":"3"},{"1":"2","2":"-0.37754244","3":"4.426933565","4":"1"},{"1":"2","2":"-1.31968621","3":"2.976799139","4":"3"},{"1":"2","2":"0.95729723","3":"1.145909931","4":"3"},{"1":"2","2":"1.85432566","3":"2.618656483","4":"1"},{"1":"2","2":"1.23102160","3":"1.963026210","4":"3"},{"1":"2","2":"0.15920747","3":"1.709734005","4":"3"},{"1":"2","2":"-0.15877317","3":"0.448120989","4":"3"},{"1":"2","2":"0.54180963","3":"2.176062542","4":"3"},{"1":"2","2":"0.53058092","3":"2.111374913","4":"3"},{"1":"2","2":"0.64692075","3":"1.085244774","4":"3"},{"1":"2","2":"-0.73254512","3":"-0.020029292","4":"3"},{"1":"2","2":"0.57667511","3":"2.730626437","4":"3"},{"1":"2","2":"-0.08289967","3":"1.065214391","4":"3"},{"1":"2","2":"-1.21817863","3":"2.859491520","4":"3"},{"1":"2","2":"-0.38557665","3":"0.291297141","4":"3"},{"1":"2","2":"0.64608933","3":"3.596537790","4":"1"},{"1":"2","2":"1.05528904","3":"1.808555456","4":"3"},{"1":"2","2":"0.72246687","3":"1.787077778","4":"3"},{"1":"2","2":"-1.24592814","3":"1.440984882","4":"3"},{"1":"2","2":"0.30229575","3":"3.121747549","4":"3"},{"1":"2","2":"-0.07086909","3":"1.692285622","4":"3"},{"1":"2","2":"-0.94926721","3":"1.292067861","4":"3"},{"1":"2","2":"1.65616475","3":"1.688693218","4":"3"},{"1":"2","2":"1.01271424","3":"2.613783769","4":"3"},{"1":"2","2":"2.17581524","3":"0.262487496","4":"3"},{"1":"2","2":"0.08640035","3":"3.242892696","4":"3"},{"1":"2","2":"0.86657397","3":"1.103885020","4":"3"},{"1":"2","2":"0.44514860","3":"1.587220613","4":"3"},{"1":"2","2":"0.33299400","3":"0.875467201","4":"3"},{"1":"2","2":"-0.50232649","3":"2.275315761","4":"3"},{"1":"2","2":"0.36409019","3":"3.588484299","4":"3"},{"1":"2","2":"-1.53870305","3":"0.844646335","4":"4"},{"1":"2","2":"1.35904186","3":"2.120448174","4":"3"},{"1":"2","2":"0.51695526","3":"2.361405211","4":"3"},{"1":"2","2":"-1.38158047","3":"2.627269647","4":"3"},{"1":"2","2":"0.17825189","3":"0.866719018","4":"3"},{"1":"2","2":"-0.24153712","3":"2.183408956","4":"3"},{"1":"2","2":"0.44680345","3":"1.404941516","4":"3"},{"1":"2","2":"0.67635698","3":"1.863885230","4":"3"},{"1":"2","2":"-0.68172931","3":"3.411550437","4":"3"},{"1":"2","2":"-1.07893553","3":"3.811295815","4":"3"},{"1":"2","2":"0.48906648","3":"0.166444253","4":"3"},{"1":"2","2":"0.08274779","3":"2.010189413","4":"3"},{"1":"2","2":"-0.01478828","3":"2.790161455","4":"3"},{"1":"2","2":"-1.86424405","3":"2.465514926","4":"3"},{"1":"2","2":"-0.37835949","3":"2.158892423","4":"3"},{"1":"2","2":"-0.93251574","3":"2.459212217","4":"3"},{"1":"2","2":"1.19958491","3":"2.294657451","4":"3"},{"1":"2","2":"-0.90356452","3":"3.170104373","4":"3"},{"1":"2","2":"-0.63739968","3":"0.981564857","4":"3"},{"1":"2","2":"-0.08361015","3":"3.470086833","4":"3"},{"1":"2","2":"1.91690780","3":"1.323535777","4":"3"},{"1":"2","2":"-1.92551582","3":"4.091399069","4":"3"},{"1":"2","2":"0.08397642","3":"1.484221315","4":"3"},{"1":"2","2":"-0.68031320","3":"1.252678573","4":"3"},{"1":"2","2":"-0.92144744","3":"1.348040830","4":"3"},{"1":"2","2":"-1.73708390","3":"2.154101770","4":"3"},{"1":"2","2":"-0.61164154","3":"1.087806428","4":"3"},{"1":"2","2":"0.48843241","3":"1.469444645","4":"3"},{"1":"2","2":"0.07756990","3":"2.126037201","4":"3"},{"1":"2","2":"-1.41871904","3":"2.948854923","4":"3"},{"1":"2","2":"0.50539940","3":"-0.088256220","4":"3"},{"1":"2","2":"0.55531773","3":"2.512812354","4":"3"},{"1":"2","2":"-0.58338782","3":"2.618513600","4":"3"},{"1":"2","2":"0.17358131","3":"2.343911334","4":"3"},{"1":"2","2":"-1.27842421","3":"1.528402620","4":"3"},{"1":"2","2":"-1.03082648","3":"0.272388457","4":"4"},{"1":"2","2":"0.13994595","3":"1.300305295","4":"3"},{"1":"2","2":"-1.02342138","3":"1.312724067","4":"3"},{"1":"2","2":"-1.24724929","3":"3.544889881","4":"3"},{"1":"2","2":"-1.04391364","3":"2.638435921","4":"3"},{"1":"3","2":"-5.18832303","3":"-0.255455158","4":"4"},{"1":"3","2":"-2.16570383","3":"-0.900751739","4":"4"},{"1":"3","2":"-2.80575468","3":"0.190537645","4":"4"},{"1":"3","2":"-2.66973006","3":"0.185288597","4":"4"},{"1":"3","2":"-3.17746332","3":"0.800998347","4":"4"},{"1":"3","2":"-2.20060135","3":"0.713141948","4":"4"},{"1":"3","2":"-3.49479695","3":"0.471758806","4":"4"},{"1":"3","2":"-3.58763588","3":"0.621312334","4":"4"},{"1":"3","2":"-3.89643294","3":"-0.105447919","4":"4"},{"1":"3","2":"-3.09216017","3":"0.229644729","4":"4"},{"1":"3","2":"-2.04258034","3":"0.314842741","4":"4"},{"1":"3","2":"-2.81065476","3":"0.122819813","4":"4"},{"1":"3","2":"-3.04258078","3":"3.124329661","4":"4"},{"1":"3","2":"-2.69216794","3":"0.071804325","4":"4"},{"1":"3","2":"-3.92153162","3":"0.680359672","4":"4"},{"1":"3","2":"-3.72228725","3":"-0.176910467","4":"4"},{"1":"3","2":"-1.90340762","3":"-0.548783464","4":"4"},{"1":"3","2":"-2.74855244","3":"-1.301091776","4":"4"},{"1":"3","2":"-0.98082705","3":"-0.225308828","4":"4"},{"1":"3","2":"-0.95296885","3":"-0.239050559","4":"4"},{"1":"3","2":"-1.75949722","3":"-1.277201098","4":"4"},{"1":"3","2":"-1.57453644","3":"0.717747520","4":"4"},{"1":"3","2":"-2.79665510","3":"-0.578668927","4":"4"},{"1":"3","2":"-2.11561283","3":"-1.668302693","4":"4"},{"1":"3","2":"-2.11785274","3":"0.841240801","4":"4"},{"1":"3","2":"-5.20452153","3":"0.341607217","4":"4"},{"1":"3","2":"-3.95736611","3":"0.978211779","4":"4"},{"1":"3","2":"-2.06421517","3":"0.105471499","4":"4"},{"1":"3","2":"-3.68898052","3":"-0.565980834","4":"4"},{"1":"3","2":"-1.86399824","3":"0.316954777","4":"4"},{"1":"3","2":"-1.27975448","3":"0.854756419","4":"4"},{"1":"3","2":"-5.35243230","3":"-0.205124512","4":"4"},{"1":"3","2":"-2.53616327","3":"0.106839864","4":"4"},{"1":"3","2":"-3.95177561","3":"-0.598948169","4":"4"},{"1":"3","2":"-2.68729783","3":"-0.424664995","4":"4"},{"1":"3","2":"-2.64844106","3":"0.612732603","4":"4"},{"1":"3","2":"-2.03337029","3":"0.817022131","4":"4"},{"1":"3","2":"-4.64856998","3":"0.191936762","4":"4"},{"1":"3","2":"-1.76072041","3":"0.042380658","4":"4"},{"1":"3","2":"-1.94106997","3":"0.032387568","4":"4"},{"1":"3","2":"-3.72535258","3":"-0.145989702","4":"4"},{"1":"3","2":"-2.46822797","3":"-0.939114921","4":"4"},{"1":"3","2":"-3.86244547","3":"1.769036855","4":"4"},{"1":"3","2":"-4.17330330","3":"1.795993476","4":"4"},{"1":"3","2":"-3.25507087","3":"0.886613456","4":"4"},{"1":"3","2":"-3.29608861","3":"0.833646432","4":"4"},{"1":"3","2":"-2.77116025","3":"-0.031073771","4":"4"},{"1":"3","2":"-2.89293951","3":"2.355407027","4":"4"},{"1":"3","2":"-3.18881214","3":"-0.212247227","4":"4"},{"1":"3","2":"-3.20565335","3":"0.010893879","4":"4"},{"1":"4","2":"1.22207270","3":"4.056293849","4":"1"},{"1":"4","2":"0.68372760","3":"4.801211135","4":"1"},{"1":"4","2":"1.70477375","3":"3.342082915","4":"1"},{"1":"4","2":"0.66858554","3":"4.043766671","4":"1"},{"1":"4","2":"2.11430682","3":"3.671729744","4":"1"},{"1":"4","2":"1.04299935","3":"4.278934246","4":"1"},{"1":"4","2":"2.27202182","3":"5.884238308","4":"1"},{"1":"4","2":"0.58155118","3":"4.575854809","4":"1"},{"1":"4","2":"3.38494959","3":"3.097593927","4":"1"},{"1":"4","2":"3.56222595","3":"4.855806554","4":"1"},{"1":"4","2":"3.08312659","3":"3.393231247","4":"1"},{"1":"4","2":"2.14309818","3":"1.127802073","4":"3"},{"1":"4","2":"2.59393846","3":"4.028626158","4":"1"},{"1":"4","2":"1.84360414","3":"2.825258920","4":"1"},{"1":"4","2":"2.36114500","3":"2.559565895","4":"1"},{"1":"4","2":"1.81500959","3":"3.373405488","4":"1"},{"1":"4","2":"3.95328104","3":"4.925799185","4":"1"},{"1":"4","2":"3.04661910","3":"4.230136235","4":"1"},{"1":"4","2":"2.25077452","3":"3.303945994","4":"1"},{"1":"4","2":"2.08634604","3":"4.356389951","4":"1"},{"1":"4","2":"0.45708749","3":"6.414055044","4":"1"},{"1":"4","2":"-0.11863719","3":"5.603526777","4":"1"},{"1":"4","2":"2.37975879","3":"0.731238144","4":"3"},{"1":"4","2":"1.20062261","3":"5.065680467","4":"1"},{"1":"4","2":"1.07596253","3":"2.194270095","4":"3"},{"1":"4","2":"2.50121337","3":"4.502197856","4":"1"},{"1":"4","2":"2.27897081","3":"1.863760968","4":"1"},{"1":"4","2":"1.54703388","3":"5.326495209","4":"1"},{"1":"4","2":"2.02306159","3":"3.597824102","4":"1"},{"1":"4","2":"-0.74707440","3":"5.455477440","4":"1"},{"1":"4","2":"2.09152431","3":"5.209511148","4":"1"},{"1":"4","2":"3.29448638","3":"5.449742189","4":"1"},{"1":"4","2":"1.21770967","3":"4.808220103","4":"1"},{"1":"4","2":"3.26276417","3":"2.184671434","4":"1"},{"1":"4","2":"1.80826716","3":"2.770656682","4":"1"},{"1":"4","2":"3.56651248","3":"6.213566151","4":"1"},{"1":"4","2":"2.17257010","3":"2.965645163","4":"1"},{"1":"4","2":"2.64451210","3":"4.120085117","4":"1"},{"1":"4","2":"2.14105621","3":"4.453595155","4":"1"},{"1":"4","2":"3.89228021","3":"4.864716781","4":"1"},{"1":"4","2":"1.99117132","3":"4.336839775","4":"1"},{"1":"4","2":"2.88686983","3":"4.563091947","4":"1"},{"1":"4","2":"1.32198984","3":"5.120755532","4":"1"},{"1":"4","2":"0.80916720","3":"3.800755963","4":"1"},{"1":"4","2":"2.43256483","3":"3.279389983","4":"1"},{"1":"4","2":"1.05688837","3":"4.784693072","4":"1"},{"1":"4","2":"5.01954853","3":"4.156558968","4":"1"},{"1":"4","2":"2.08488644","3":"5.115530544","4":"1"},{"1":"4","2":"1.53082349","3":"5.419587779","4":"1"},{"1":"4","2":"1.38856628","3":"4.932522955","4":"1"},{"1":"4","2":"2.20058949","3":"5.031584596","4":"1"},{"1":"4","2":"2.93246203","3":"2.994095646","4":"1"},{"1":"4","2":"1.52906361","3":"2.632511594","4":"1"},{"1":"4","2":"0.94814952","3":"5.205652800","4":"1"},{"1":"4","2":"4.05770126","3":"3.139503412","4":"1"},{"1":"4","2":"2.80387572","3":"3.645244344","4":"1"},{"1":"4","2":"2.42570222","3":"3.996276073","4":"1"},{"1":"4","2":"3.56417293","3":"3.573720765","4":"1"},{"1":"4","2":"1.94003993","3":"4.976600517","4":"1"},{"1":"4","2":"2.33147183","3":"4.001751888","4":"1"},{"1":"4","2":"1.75204414","3":"4.431085453","4":"1"},{"1":"4","2":"1.41300800","3":"3.674315043","4":"1"},{"1":"4","2":"2.94145235","3":"4.299225478","4":"1"},{"1":"4","2":"2.31959500","3":"4.710999124","4":"1"},{"1":"4","2":"3.19463309","3":"3.490049566","4":"1"},{"1":"4","2":"3.57313000","3":"2.512310967","4":"1"},{"1":"4","2":"1.80581654","3":"3.383922647","4":"1"},{"1":"4","2":"1.30848025","3":"3.350502672","4":"1"},{"1":"4","2":"2.35910562","3":"3.414542940","4":"1"},{"1":"4","2":"2.44905764","3":"4.083582475","4":"1"},{"1":"4","2":"2.04747832","3":"3.616973040","4":"1"},{"1":"4","2":"1.83103112","3":"3.485945323","4":"1"},{"1":"4","2":"1.12321782","3":"4.714415606","4":"1"},{"1":"4","2":"2.00618420","3":"4.882615479","4":"1"},{"1":"4","2":"0.67139031","3":"4.257771941","4":"1"},{"1":"4","2":"1.41705133","3":"4.163812217","4":"1"},{"1":"4","2":"2.00570653","3":"4.952475751","4":"1"},{"1":"4","2":"1.36491387","3":"3.128253090","4":"1"},{"1":"4","2":"1.18714118","3":"4.087840638","4":"1"},{"1":"4","2":"2.28494492","3":"6.076272414","4":"1"},{"1":"4","2":"2.67522018","3":"5.290581612","4":"1"},{"1":"4","2":"1.56948686","3":"4.401168205","4":"1"},{"1":"4","2":"2.86726045","3":"2.966039740","4":"1"},{"1":"4","2":"1.74996129","3":"2.594452105","4":"1"},{"1":"4","2":"0.76247841","3":"4.327810147","4":"1"},{"1":"4","2":"1.32134343","3":"5.375492667","4":"1"},{"1":"4","2":"0.08017742","3":"3.327130164","4":"3"},{"1":"4","2":"2.22891529","3":"2.560899808","4":"1"},{"1":"4","2":"1.14057490","3":"4.036761156","4":"1"},{"1":"4","2":"2.41582657","3":"3.316218336","4":"1"},{"1":"4","2":"1.24386044","3":"4.509290654","4":"1"},{"1":"4","2":"4.13069102","3":"6.075903516","4":"1"},{"1":"4","2":"4.05413365","3":"4.315188418","4":"1"},{"1":"4","2":"1.64309327","3":"4.126757281","4":"1"},{"1":"4","2":"2.65385405","3":"4.783125068","4":"1"},{"1":"4","2":"2.10138025","3":"3.378105782","4":"1"},{"1":"4","2":"1.40051371","3":"3.359308555","4":"1"},{"1":"4","2":"1.92309023","3":"4.538544414","4":"1"},{"1":"4","2":"1.89050508","3":"3.855134545","4":"1"},{"1":"4","2":"2.51839013","3":"2.727378375","4":"1"},{"1":"4","2":"1.56945077","3":"2.841032756","4":"1"},{"1":"4","2":"1.81476151","3":"3.933329427","4":"1"},{"1":"4","2":"2.54588350","3":"3.907700347","4":"1"},{"1":"4","2":"1.96483633","3":"3.524862363","4":"1"},{"1":"4","2":"2.13051136","3":"4.629178307","4":"1"},{"1":"4","2":"1.54942960","3":"4.389269052","4":"1"},{"1":"4","2":"2.44910505","3":"4.050345928","4":"1"},{"1":"4","2":"1.63569816","3":"3.892451559","4":"1"},{"1":"4","2":"1.90262615","3":"4.121608081","4":"1"},{"1":"4","2":"2.70653440","3":"4.318055507","4":"1"},{"1":"4","2":"0.61519136","3":"4.962559985","4":"1"},{"1":"4","2":"2.14703353","3":"4.267535224","4":"1"},{"1":"4","2":"2.25614769","3":"3.049293124","4":"1"},{"1":"4","2":"2.51157220","3":"2.462467794","4":"1"},{"1":"4","2":"4.01281492","3":"4.335173790","4":"1"},{"1":"4","2":"2.14239229","3":"5.142054200","4":"1"},{"1":"4","2":"0.43045651","3":"1.425732035","4":"3"},{"1":"4","2":"3.13288241","3":"3.037635448","4":"1"},{"1":"4","2":"1.41760371","3":"3.868957625","4":"1"},{"1":"4","2":"2.27640705","3":"2.859315893","4":"1"},{"1":"4","2":"2.72943687","3":"4.519931208","4":"1"},{"1":"4","2":"1.96082191","3":"4.245643067","4":"1"},{"1":"4","2":"2.99325448","3":"4.871736355","4":"1"},{"1":"4","2":"4.59955054","3":"3.138612709","4":"1"},{"1":"4","2":"1.78209205","3":"2.896966308","4":"1"},{"1":"4","2":"2.31245505","3":"4.471388402","4":"1"},{"1":"4","2":"2.55848583","3":"4.748737882","4":"1"},{"1":"4","2":"3.00598041","3":"2.473728572","4":"1"},{"1":"4","2":"1.44316262","3":"4.707414672","4":"1"},{"1":"4","2":"2.07085476","3":"3.404982176","4":"1"},{"1":"4","2":"1.82460964","3":"3.066994263","4":"1"},{"1":"4","2":"2.14105895","3":"4.347617280","4":"1"},{"1":"4","2":"2.46047467","3":"2.435793700","4":"1"},{"1":"4","2":"1.81323114","3":"5.225830499","4":"1"},{"1":"4","2":"1.12606175","3":"4.379930828","4":"1"},{"1":"4","2":"2.73936587","3":"2.712959107","4":"1"},{"1":"4","2":"1.05077609","3":"3.346620250","4":"1"},{"1":"4","2":"2.99861377","3":"3.507698544","4":"1"},{"1":"4","2":"0.80396482","3":"5.222818694","4":"1"},{"1":"4","2":"1.11192511","3":"4.750990038","4":"1"},{"1":"4","2":"3.41269262","3":"3.187101359","4":"1"},{"1":"4","2":"3.70710586","3":"5.085854616","4":"1"},{"1":"4","2":"2.75271284","3":"3.850299022","4":"1"},{"1":"4","2":"2.34371360","3":"4.117445427","4":"1"},{"1":"4","2":"3.09826223","3":"3.943590429","4":"1"},{"1":"4","2":"2.25542636","3":"2.423053310","4":"1"},{"1":"4","2":"1.58724495","3":"4.413124369","4":"1"},{"1":"4","2":"2.31032862","3":"4.152221997","4":"1"},{"1":"4","2":"1.91218225","3":"1.693447702","4":"3"},{"1":"4","2":"2.48027095","3":"3.676423798","4":"1"},{"1":"4","2":"2.64627641","3":"6.251832238","4":"1"},{"1":"4","2":"3.36148364","3":"2.464421689","4":"1"},{"1":"4","2":"0.98093610","3":"2.462500966","4":"3"},{"1":"4","2":"0.68057503","3":"3.206546463","4":"3"},{"1":"4","2":"1.11093371","3":"4.209585243","4":"1"},{"1":"4","2":"2.22284868","3":"4.016119963","4":"1"},{"1":"4","2":"2.93193237","3":"3.120726892","4":"1"},{"1":"4","2":"1.13595161","3":"2.722004491","4":"3"},{"1":"4","2":"2.13157386","3":"4.134338668","4":"1"},{"1":"4","2":"2.73508491","3":"5.160880748","4":"1"},{"1":"4","2":"1.77664379","3":"4.765867673","4":"1"},{"1":"4","2":"2.21471620","3":"4.384863875","4":"1"},{"1":"4","2":"0.43276347","3":"4.262304914","4":"1"},{"1":"4","2":"3.46444951","3":"3.396408522","4":"1"},{"1":"4","2":"1.45270316","3":"4.241461924","4":"1"},{"1":"4","2":"3.75796547","3":"4.006116142","4":"1"},{"1":"4","2":"1.33895339","3":"4.580065845","4":"1"},{"1":"4","2":"2.66477066","3":"4.305695036","4":"1"},{"1":"4","2":"0.73568695","3":"3.248426165","4":"3"},{"1":"4","2":"0.49358098","3":"3.593233085","4":"1"},{"1":"4","2":"1.32564761","3":"3.170563924","4":"1"},{"1":"4","2":"3.54989173","3":"4.454936520","4":"1"},{"1":"4","2":"1.24790012","3":"4.164524794","4":"1"},{"1":"4","2":"3.39049546","3":"4.712206002","4":"1"},{"1":"4","2":"0.95573505","3":"3.246490073","4":"1"},{"1":"4","2":"1.93507666","3":"4.791903972","4":"1"},{"1":"4","2":"2.72772968","3":"3.378586702","4":"1"},{"1":"4","2":"2.81679316","3":"3.151078702","4":"1"},{"1":"4","2":"1.30137641","3":"4.137421046","4":"1"},{"1":"4","2":"2.15585502","3":"2.742561467","4":"1"},{"1":"4","2":"1.10389275","3":"4.994723225","4":"1"},{"1":"4","2":"1.51865241","3":"2.826451837","4":"1"},{"1":"4","2":"1.73209918","3":"4.715769346","4":"1"},{"1":"4","2":"2.02650086","3":"4.499423710","4":"1"},{"1":"4","2":"1.35496879","3":"3.629299077","4":"1"},{"1":"4","2":"3.08025264","3":"4.026084317","4":"1"},{"1":"4","2":"1.21094993","3":"1.038717469","4":"3"},{"1":"4","2":"1.27058468","3":"4.396089868","4":"1"},{"1":"4","2":"2.02247474","3":"4.668084947","4":"1"},{"1":"4","2":"2.69146624","3":"1.978071207","4":"1"},{"1":"4","2":"1.78600913","3":"4.043401357","4":"1"},{"1":"4","2":"2.89875061","3":"4.112820729","4":"1"},{"1":"4","2":"3.18005149","3":"3.617241636","4":"1"},{"1":"4","2":"3.35981226","3":"3.151378895","4":"1"},{"1":"4","2":"2.17172689","3":"3.246661403","4":"1"},{"1":"4","2":"2.17689189","3":"3.314594446","4":"1"},{"1":"4","2":"0.86601228","3":"5.785075318","4":"1"},{"1":"4","2":"1.61792456","3":"3.184819548","4":"1"},{"1":"4","2":"1.57501107","3":"3.392743061","4":"1"},{"1":"4","2":"2.53010350","3":"4.017752776","4":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

```r
# The tidy() function summarizes on a per-cluster level as a tibble:

tidy(kclust)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["x1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["x2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["size"],"name":[3],"type":["int"],"align":["right"]},{"label":["withinss"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["cluster"],"name":[5],"type":["fct"],"align":["left"]}],"data":[{"1":"2.10067656","2":"4.0165848","3":"195","4":"325.2082","5":"1"},{"1":"4.93754043","2":"-0.9851590","3":"100","4":"193.9269","5":"2"},{"1":"0.04500604","2":"1.8702414","3":"147","4":"253.1424","5":"3"},{"1":"-2.78183242","2":"0.3612606","3":"58","4":"113.2072","5":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

```r
# The glance() function extracts a single random row summary as a tibble:

glance(kclust)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["totss"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["tot.withinss"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["betweenss"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["iter"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"5353.672","2":"885.4847","3":"4468.187","4":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

```r
# Let's see how good our clustering was! 

original <- ggplot(labelled_points, aes(x1, x2, color = cluster)) +
  geom_point(alpha = 0.5) + 
  theme_bw() + 
  ggtitle("Original")

kmeans_clustered <- augment(kclust, points) %>% 
  ggplot(aes(x1,x2, color = .cluster)) + 
  geom_point(alpha = 0.5) + 
  theme_bw() + 
  ggtitle("K-means Clustering")

original
```

![](week-8---class-1---Clustering-with-k-means_files/figure-html/unnamed-chunk-5-1.png)<!-- -->

```r
kmeans_clustered
```

![](week-8---class-1---Clustering-with-k-means_files/figure-html/unnamed-chunk-5-2.png)<!-- -->


```r
# This is pretty good! 
# ... but what if we didn't know how many clusters we wanted to find first? 
# We could iterately search! 

# Let’s say we want to explore the effect of different choices of k, from 1 to 9, on this clustering.
# First cluster the data 12 times, each using a different value of k, then create columns containing the tidied, glanced and augmented data:

k_search <- 
  tibble(k = 1:12) %>% # make a tibble with a variable k containing values from 1 to 12
  mutate(
    kclust = map(k, ~kmeans(labelled_points, .x)),
    tidied = map(kclust, tidy),
    glanced = map(kclust, glance),
    augmented = map(kclust, augment, labelled_points)
  ) # make 4 new columns


# map: Apply a function to each element of a vector
# you might be saying "woah, what is this map" stuff. Let's look! 
?purrr::map
```

```
## starting httpd help server ... done
```

```r
# Now let's extract those breakdowns we saw before: tidied, augmented, and glanced 

clusters <- 
  k_search %>%
  unnest(cols = c(tidied)) # unnest() pulls things out of a vector

assignments <- 
  k_search %>% 
  unnest(cols = c(augmented))

clusterings <- 
  k_search %>%
  unnest(cols = c(glanced))

# We can use the augmented bits to visualize the "search" 
# through all values of k 
assignments %>% 
  ggplot(aes(x = x1, y = x2)) +
  geom_point(aes(color = .cluster), alpha = 0.8) + 
  facet_wrap(~ k) + 
  theme_bw()
```

![](week-8---class-1---Clustering-with-k-means_files/figure-html/unnamed-chunk-6-1.png)<!-- -->

```r
# We could then add the estimated centroids
# by using the tidied summaries

assignments %>% 
  ggplot(aes(x = x1, y = x2)) +
  geom_point(aes(color = .cluster), alpha = 0.8) + 
  facet_wrap(~ k) + 
  geom_point(data = clusters, size = 10, shape = "x")+ 
  theme_bw()
```

![](week-8---class-1---Clustering-with-k-means_files/figure-html/unnamed-chunk-6-2.png)<!-- -->

```r
# What in the world would we do with the glanced data?
# The data from glance() fills a different but equally important purpose; 
# it lets us view trends of some summary statistics across values of k. 
# Of particular interest is the total within sum of squares, saved in the tot.withinss column.
# This let's us visualize an "elbow plot" 

# when you are at the most convex part of the elbow plot is when your model is working best. The optimal k means for this data set that we built is 4, and as expected, you can see that the most convex part of the plot is a little before k = 5 (so k = 4 heck yeah! it works!)

ggplot(clusterings, aes(k, tot.withinss)) +
  geom_line() +
  geom_point() + 
  theme_bw()
```

![](week-8---class-1---Clustering-with-k-means_files/figure-html/unnamed-chunk-6-3.png)<!-- -->



```r
#############################
#
# Your turn! 
#
#############################


# Use the iris dataset (use the command data(iris)). Draw a scatterplot showing sepal length on the x-axis and petal length on the y-axis. 
# Color the dots by species. Then perform a k-means clustering with 3 clusters. Plot your clusters in the same fashion. 

iris
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["Sepal.Length"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sepal.Width"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Petal.Length"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Petal.Width"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Species"],"name":[5],"type":["fct"],"align":["left"]}],"data":[{"1":"5.1","2":"3.5","3":"1.4","4":"0.2","5":"setosa"},{"1":"4.9","2":"3.0","3":"1.4","4":"0.2","5":"setosa"},{"1":"4.7","2":"3.2","3":"1.3","4":"0.2","5":"setosa"},{"1":"4.6","2":"3.1","3":"1.5","4":"0.2","5":"setosa"},{"1":"5.0","2":"3.6","3":"1.4","4":"0.2","5":"setosa"},{"1":"5.4","2":"3.9","3":"1.7","4":"0.4","5":"setosa"},{"1":"4.6","2":"3.4","3":"1.4","4":"0.3","5":"setosa"},{"1":"5.0","2":"3.4","3":"1.5","4":"0.2","5":"setosa"},{"1":"4.4","2":"2.9","3":"1.4","4":"0.2","5":"setosa"},{"1":"4.9","2":"3.1","3":"1.5","4":"0.1","5":"setosa"},{"1":"5.4","2":"3.7","3":"1.5","4":"0.2","5":"setosa"},{"1":"4.8","2":"3.4","3":"1.6","4":"0.2","5":"setosa"},{"1":"4.8","2":"3.0","3":"1.4","4":"0.1","5":"setosa"},{"1":"4.3","2":"3.0","3":"1.1","4":"0.1","5":"setosa"},{"1":"5.8","2":"4.0","3":"1.2","4":"0.2","5":"setosa"},{"1":"5.7","2":"4.4","3":"1.5","4":"0.4","5":"setosa"},{"1":"5.4","2":"3.9","3":"1.3","4":"0.4","5":"setosa"},{"1":"5.1","2":"3.5","3":"1.4","4":"0.3","5":"setosa"},{"1":"5.7","2":"3.8","3":"1.7","4":"0.3","5":"setosa"},{"1":"5.1","2":"3.8","3":"1.5","4":"0.3","5":"setosa"},{"1":"5.4","2":"3.4","3":"1.7","4":"0.2","5":"setosa"},{"1":"5.1","2":"3.7","3":"1.5","4":"0.4","5":"setosa"},{"1":"4.6","2":"3.6","3":"1.0","4":"0.2","5":"setosa"},{"1":"5.1","2":"3.3","3":"1.7","4":"0.5","5":"setosa"},{"1":"4.8","2":"3.4","3":"1.9","4":"0.2","5":"setosa"},{"1":"5.0","2":"3.0","3":"1.6","4":"0.2","5":"setosa"},{"1":"5.0","2":"3.4","3":"1.6","4":"0.4","5":"setosa"},{"1":"5.2","2":"3.5","3":"1.5","4":"0.2","5":"setosa"},{"1":"5.2","2":"3.4","3":"1.4","4":"0.2","5":"setosa"},{"1":"4.7","2":"3.2","3":"1.6","4":"0.2","5":"setosa"},{"1":"4.8","2":"3.1","3":"1.6","4":"0.2","5":"setosa"},{"1":"5.4","2":"3.4","3":"1.5","4":"0.4","5":"setosa"},{"1":"5.2","2":"4.1","3":"1.5","4":"0.1","5":"setosa"},{"1":"5.5","2":"4.2","3":"1.4","4":"0.2","5":"setosa"},{"1":"4.9","2":"3.1","3":"1.5","4":"0.2","5":"setosa"},{"1":"5.0","2":"3.2","3":"1.2","4":"0.2","5":"setosa"},{"1":"5.5","2":"3.5","3":"1.3","4":"0.2","5":"setosa"},{"1":"4.9","2":"3.6","3":"1.4","4":"0.1","5":"setosa"},{"1":"4.4","2":"3.0","3":"1.3","4":"0.2","5":"setosa"},{"1":"5.1","2":"3.4","3":"1.5","4":"0.2","5":"setosa"},{"1":"5.0","2":"3.5","3":"1.3","4":"0.3","5":"setosa"},{"1":"4.5","2":"2.3","3":"1.3","4":"0.3","5":"setosa"},{"1":"4.4","2":"3.2","3":"1.3","4":"0.2","5":"setosa"},{"1":"5.0","2":"3.5","3":"1.6","4":"0.6","5":"setosa"},{"1":"5.1","2":"3.8","3":"1.9","4":"0.4","5":"setosa"},{"1":"4.8","2":"3.0","3":"1.4","4":"0.3","5":"setosa"},{"1":"5.1","2":"3.8","3":"1.6","4":"0.2","5":"setosa"},{"1":"4.6","2":"3.2","3":"1.4","4":"0.2","5":"setosa"},{"1":"5.3","2":"3.7","3":"1.5","4":"0.2","5":"setosa"},{"1":"5.0","2":"3.3","3":"1.4","4":"0.2","5":"setosa"},{"1":"7.0","2":"3.2","3":"4.7","4":"1.4","5":"versicolor"},{"1":"6.4","2":"3.2","3":"4.5","4":"1.5","5":"versicolor"},{"1":"6.9","2":"3.1","3":"4.9","4":"1.5","5":"versicolor"},{"1":"5.5","2":"2.3","3":"4.0","4":"1.3","5":"versicolor"},{"1":"6.5","2":"2.8","3":"4.6","4":"1.5","5":"versicolor"},{"1":"5.7","2":"2.8","3":"4.5","4":"1.3","5":"versicolor"},{"1":"6.3","2":"3.3","3":"4.7","4":"1.6","5":"versicolor"},{"1":"4.9","2":"2.4","3":"3.3","4":"1.0","5":"versicolor"},{"1":"6.6","2":"2.9","3":"4.6","4":"1.3","5":"versicolor"},{"1":"5.2","2":"2.7","3":"3.9","4":"1.4","5":"versicolor"},{"1":"5.0","2":"2.0","3":"3.5","4":"1.0","5":"versicolor"},{"1":"5.9","2":"3.0","3":"4.2","4":"1.5","5":"versicolor"},{"1":"6.0","2":"2.2","3":"4.0","4":"1.0","5":"versicolor"},{"1":"6.1","2":"2.9","3":"4.7","4":"1.4","5":"versicolor"},{"1":"5.6","2":"2.9","3":"3.6","4":"1.3","5":"versicolor"},{"1":"6.7","2":"3.1","3":"4.4","4":"1.4","5":"versicolor"},{"1":"5.6","2":"3.0","3":"4.5","4":"1.5","5":"versicolor"},{"1":"5.8","2":"2.7","3":"4.1","4":"1.0","5":"versicolor"},{"1":"6.2","2":"2.2","3":"4.5","4":"1.5","5":"versicolor"},{"1":"5.6","2":"2.5","3":"3.9","4":"1.1","5":"versicolor"},{"1":"5.9","2":"3.2","3":"4.8","4":"1.8","5":"versicolor"},{"1":"6.1","2":"2.8","3":"4.0","4":"1.3","5":"versicolor"},{"1":"6.3","2":"2.5","3":"4.9","4":"1.5","5":"versicolor"},{"1":"6.1","2":"2.8","3":"4.7","4":"1.2","5":"versicolor"},{"1":"6.4","2":"2.9","3":"4.3","4":"1.3","5":"versicolor"},{"1":"6.6","2":"3.0","3":"4.4","4":"1.4","5":"versicolor"},{"1":"6.8","2":"2.8","3":"4.8","4":"1.4","5":"versicolor"},{"1":"6.7","2":"3.0","3":"5.0","4":"1.7","5":"versicolor"},{"1":"6.0","2":"2.9","3":"4.5","4":"1.5","5":"versicolor"},{"1":"5.7","2":"2.6","3":"3.5","4":"1.0","5":"versicolor"},{"1":"5.5","2":"2.4","3":"3.8","4":"1.1","5":"versicolor"},{"1":"5.5","2":"2.4","3":"3.7","4":"1.0","5":"versicolor"},{"1":"5.8","2":"2.7","3":"3.9","4":"1.2","5":"versicolor"},{"1":"6.0","2":"2.7","3":"5.1","4":"1.6","5":"versicolor"},{"1":"5.4","2":"3.0","3":"4.5","4":"1.5","5":"versicolor"},{"1":"6.0","2":"3.4","3":"4.5","4":"1.6","5":"versicolor"},{"1":"6.7","2":"3.1","3":"4.7","4":"1.5","5":"versicolor"},{"1":"6.3","2":"2.3","3":"4.4","4":"1.3","5":"versicolor"},{"1":"5.6","2":"3.0","3":"4.1","4":"1.3","5":"versicolor"},{"1":"5.5","2":"2.5","3":"4.0","4":"1.3","5":"versicolor"},{"1":"5.5","2":"2.6","3":"4.4","4":"1.2","5":"versicolor"},{"1":"6.1","2":"3.0","3":"4.6","4":"1.4","5":"versicolor"},{"1":"5.8","2":"2.6","3":"4.0","4":"1.2","5":"versicolor"},{"1":"5.0","2":"2.3","3":"3.3","4":"1.0","5":"versicolor"},{"1":"5.6","2":"2.7","3":"4.2","4":"1.3","5":"versicolor"},{"1":"5.7","2":"3.0","3":"4.2","4":"1.2","5":"versicolor"},{"1":"5.7","2":"2.9","3":"4.2","4":"1.3","5":"versicolor"},{"1":"6.2","2":"2.9","3":"4.3","4":"1.3","5":"versicolor"},{"1":"5.1","2":"2.5","3":"3.0","4":"1.1","5":"versicolor"},{"1":"5.7","2":"2.8","3":"4.1","4":"1.3","5":"versicolor"},{"1":"6.3","2":"3.3","3":"6.0","4":"2.5","5":"virginica"},{"1":"5.8","2":"2.7","3":"5.1","4":"1.9","5":"virginica"},{"1":"7.1","2":"3.0","3":"5.9","4":"2.1","5":"virginica"},{"1":"6.3","2":"2.9","3":"5.6","4":"1.8","5":"virginica"},{"1":"6.5","2":"3.0","3":"5.8","4":"2.2","5":"virginica"},{"1":"7.6","2":"3.0","3":"6.6","4":"2.1","5":"virginica"},{"1":"4.9","2":"2.5","3":"4.5","4":"1.7","5":"virginica"},{"1":"7.3","2":"2.9","3":"6.3","4":"1.8","5":"virginica"},{"1":"6.7","2":"2.5","3":"5.8","4":"1.8","5":"virginica"},{"1":"7.2","2":"3.6","3":"6.1","4":"2.5","5":"virginica"},{"1":"6.5","2":"3.2","3":"5.1","4":"2.0","5":"virginica"},{"1":"6.4","2":"2.7","3":"5.3","4":"1.9","5":"virginica"},{"1":"6.8","2":"3.0","3":"5.5","4":"2.1","5":"virginica"},{"1":"5.7","2":"2.5","3":"5.0","4":"2.0","5":"virginica"},{"1":"5.8","2":"2.8","3":"5.1","4":"2.4","5":"virginica"},{"1":"6.4","2":"3.2","3":"5.3","4":"2.3","5":"virginica"},{"1":"6.5","2":"3.0","3":"5.5","4":"1.8","5":"virginica"},{"1":"7.7","2":"3.8","3":"6.7","4":"2.2","5":"virginica"},{"1":"7.7","2":"2.6","3":"6.9","4":"2.3","5":"virginica"},{"1":"6.0","2":"2.2","3":"5.0","4":"1.5","5":"virginica"},{"1":"6.9","2":"3.2","3":"5.7","4":"2.3","5":"virginica"},{"1":"5.6","2":"2.8","3":"4.9","4":"2.0","5":"virginica"},{"1":"7.7","2":"2.8","3":"6.7","4":"2.0","5":"virginica"},{"1":"6.3","2":"2.7","3":"4.9","4":"1.8","5":"virginica"},{"1":"6.7","2":"3.3","3":"5.7","4":"2.1","5":"virginica"},{"1":"7.2","2":"3.2","3":"6.0","4":"1.8","5":"virginica"},{"1":"6.2","2":"2.8","3":"4.8","4":"1.8","5":"virginica"},{"1":"6.1","2":"3.0","3":"4.9","4":"1.8","5":"virginica"},{"1":"6.4","2":"2.8","3":"5.6","4":"2.1","5":"virginica"},{"1":"7.2","2":"3.0","3":"5.8","4":"1.6","5":"virginica"},{"1":"7.4","2":"2.8","3":"6.1","4":"1.9","5":"virginica"},{"1":"7.9","2":"3.8","3":"6.4","4":"2.0","5":"virginica"},{"1":"6.4","2":"2.8","3":"5.6","4":"2.2","5":"virginica"},{"1":"6.3","2":"2.8","3":"5.1","4":"1.5","5":"virginica"},{"1":"6.1","2":"2.6","3":"5.6","4":"1.4","5":"virginica"},{"1":"7.7","2":"3.0","3":"6.1","4":"2.3","5":"virginica"},{"1":"6.3","2":"3.4","3":"5.6","4":"2.4","5":"virginica"},{"1":"6.4","2":"3.1","3":"5.5","4":"1.8","5":"virginica"},{"1":"6.0","2":"3.0","3":"4.8","4":"1.8","5":"virginica"},{"1":"6.9","2":"3.1","3":"5.4","4":"2.1","5":"virginica"},{"1":"6.7","2":"3.1","3":"5.6","4":"2.4","5":"virginica"},{"1":"6.9","2":"3.1","3":"5.1","4":"2.3","5":"virginica"},{"1":"5.8","2":"2.7","3":"5.1","4":"1.9","5":"virginica"},{"1":"6.8","2":"3.2","3":"5.9","4":"2.3","5":"virginica"},{"1":"6.7","2":"3.3","3":"5.7","4":"2.5","5":"virginica"},{"1":"6.7","2":"3.0","3":"5.2","4":"2.3","5":"virginica"},{"1":"6.3","2":"2.5","3":"5.0","4":"1.9","5":"virginica"},{"1":"6.5","2":"3.0","3":"5.2","4":"2.0","5":"virginica"},{"1":"6.2","2":"3.4","3":"5.4","4":"2.3","5":"virginica"},{"1":"5.9","2":"3.0","3":"5.1","4":"1.8","5":"virginica"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

```r
iris %>% 
  ggplot(aes(x=Sepal.Length, y=Petal.Length, colour=Species)) +
  geom_point()
```

![](week-8---class-1---Clustering-with-k-means_files/figure-html/unnamed-chunk-7-1.png)<!-- -->

```r
iris %>% 
  select(Sepal.Length, Petal.Length) %>%
  kmeans(., centers = 3) %>% 
  augment(., iris) %>% 
  ggplot(aes(x=Sepal.Length, y=Petal.Length, colour=.cluster)) +
  geom_point()
```

![](week-8---class-1---Clustering-with-k-means_files/figure-html/unnamed-chunk-7-2.png)<!-- -->

```r
# Use the iris dataset again. Perform a k-means clustering search for all values of k between 1 and 9 when comparing sepal width and petal width. 
# Create an elbow plot and decide which is the best value of k to choose. 

iris_select <- iris %>% 
  select(Sepal.Width, Petal.Width)

iris_k_search <- 
  tibble(k = 1:9) %>%
  mutate(
    kclust = map(k, ~kmeans(iris_select, .x)),
    tidied = map(kclust, tidy),
    glanced = map(kclust, glance),
    augmented = map(kclust, augment, iris_select)
  )

# Now let's extract those breakdowns we saw before: tidied, augmented, and glanced 

iris_clusters <- 
  iris_k_search %>%
  unnest(cols = c(tidied)) # unnest() pulls things out of a vector

iris_assignments <- 
  iris_k_search %>% 
  unnest(cols = c(augmented))

iris_clusterings <- 
  iris_k_search %>%
  unnest(cols = c(glanced))

iris_assignments %>% 
  ggplot(aes(x = Sepal.Width, y = Petal.Width)) +
  geom_point(aes(color = .cluster), alpha = 0.8) + 
  facet_wrap(~ k) + 
  theme_bw()
```

![](week-8---class-1---Clustering-with-k-means_files/figure-html/unnamed-chunk-7-3.png)<!-- -->

```r
ggplot(iris_clusterings, aes(k, tot.withinss)) +
  geom_line() +
  geom_point() + 
  theme_bw()
```

![](week-8---class-1---Clustering-with-k-means_files/figure-html/unnamed-chunk-7-4.png)<!-- -->

